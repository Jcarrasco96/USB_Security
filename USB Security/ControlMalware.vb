Imports vblibusb.LogicUSB
Imports Microsoft.VisualBasic.FileIO

Public Class ControlMalware

    Private Sub ControlMalware_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        LoadMalware()
    End Sub

    Private Sub MysticButton3_Click(sender As Object, e As EventArgs) Handles btnRestore.Click
        ' TODO
        LoadMalware()
    End Sub

    Private Sub MysticButton1_Click(sender As Object, e As EventArgs) Handles btnDelete.Click
        If My.Computer.FileSystem.FileExists(DirProject & "log_malware.log") Then My.Computer.FileSystem.DeleteFile(DirProject & "log_malware.log", UIOption.OnlyErrorDialogs, RecycleOption.DeletePermanently)
        LoadMalware()
    End Sub

    Public Sub LoadMalware()
        Dim filename As String = DirProject & "log_malware.log"

        listViewMalwares.Items.Clear()

        If My.Computer.FileSystem.GetFileInfo(filename).Exists Then
            Dim fields As String()
            Dim parser As New TextFieldParser(filename)
            parser.SetDelimiters("*")
            While Not parser.EndOfData
                fields = parser.ReadFields()

                If fields.Length = 6 Then
                    Dim s = New ListViewItem(fields(0))

                    s.SubItems.Add(fields(1))
                    s.SubItems.Add(fields(2))
                    s.SubItems.Add(fields(3))
                    s.SubItems.Add(fields(4))
                    s.SubItems.Add(fields(5))

                    listViewMalwares.Items.Add(s)
                End If
            End While
            parser.Close()
        End If

        btnDelete.Enabled = listViewMalwares.Items.Count <> 0
        btnSave.Enabled = listViewMalwares.Items.Count <> 0
    End Sub

    Private Sub btnSave_Click(sender As Object, e As EventArgs) Handles btnSave.Click
        ' TODO
    End Sub

End Class
